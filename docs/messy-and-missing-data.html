<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals</title>
  <meta name="description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="github-repo" content="https://github.com/mharbur/ds-oct21c" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals" />
  
  <meta name="twitter:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  

<meta name="author" content="Marin L. Harbur" />


<meta name="date" content="2021-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="means-separation-and-data-presentation.html"/>
<link rel="next" href="correlation-and-simple-regression.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/stars_1f4d28-1/data_stars_starsf098bd.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="libs/stars_f4bdc0-1/data_stars_starsd4cae3.txt"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Science for Agricultural Professionals</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-language"><i class="fa fa-check"></i>R-language</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="population-statistics.html"><a href="population-statistics.html"><i class="fa fa-check"></i><b>1</b> Population Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="population-statistics.html"><a href="population-statistics.html#populations"><i class="fa fa-check"></i><b>1.1</b> Populations</a></li>
<li class="chapter" data-level="1.2" data-path="population-statistics.html"><a href="population-statistics.html#case-study-yield-map"><i class="fa fa-check"></i><b>1.2</b> Case Study: Yield Map</a></li>
<li class="chapter" data-level="1.3" data-path="population-statistics.html"><a href="population-statistics.html#distributions"><i class="fa fa-check"></i><b>1.3</b> Distributions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="population-statistics.html"><a href="population-statistics.html#histograms"><i class="fa fa-check"></i><b>1.3.1</b> Histograms</a></li>
<li class="chapter" data-level="1.3.2" data-path="population-statistics.html"><a href="population-statistics.html#percentiles"><i class="fa fa-check"></i><b>1.3.2</b> Percentiles</a></li>
<li class="chapter" data-level="1.3.3" data-path="population-statistics.html"><a href="population-statistics.html#normal-distribution-model"><i class="fa fa-check"></i><b>1.3.3</b> Normal Distribution Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>1.3.4</b> Measures of Center</a></li>
<li class="chapter" data-level="1.3.5" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-dispersion"><i class="fa fa-check"></i><b>1.3.5</b> Measures of Dispersion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html"><i class="fa fa-check"></i><b>2</b> Distributions and Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study"><i class="fa fa-check"></i><b>2.1</b> Case Study</a></li>
<li class="chapter" data-level="2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-normal-distribution-model"><i class="fa fa-check"></i><b>2.2</b> The Normal Distribution Model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-bell-curve"><i class="fa fa-check"></i><b>2.2.1</b> The Bell Curve</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#distribution-and-probability"><i class="fa fa-check"></i><b>2.2.2</b> Distribution and Probability</a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-the-normal-distribution-curve"><i class="fa fa-check"></i><b>2.2.3</b> Probability and the Normal Distribution Curve</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-z-distribution"><i class="fa fa-check"></i><b>2.3</b> The Z-Distribution</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#important-numbers-95-and-5"><i class="fa fa-check"></i><b>2.3.1</b> Important Numbers: 95% and 5%</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-statistics.html"><a href="sample-statistics.html"><i class="fa fa-check"></i><b>3</b> Sample Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sample-statistics.html"><a href="sample-statistics.html#samples"><i class="fa fa-check"></i><b>3.1</b> Samples</a></li>
<li class="chapter" data-level="3.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-1"><i class="fa fa-check"></i><b>3.2</b> Case Study</a></li>
<li class="chapter" data-level="3.3" data-path="sample-statistics.html"><a href="sample-statistics.html#distribution-of-sample-means"><i class="fa fa-check"></i><b>3.3</b> Distribution of Sample Means</a></li>
<li class="chapter" data-level="3.4" data-path="sample-statistics.html"><a href="sample-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="3.5" data-path="sample-statistics.html"><a href="sample-statistics.html#standard-error"><i class="fa fa-check"></i><b>3.5</b> Standard Error</a></li>
<li class="chapter" data-level="3.6" data-path="sample-statistics.html"><a href="sample-statistics.html#degrees-of-freedom"><i class="fa fa-check"></i><b>3.6</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="3.7" data-path="sample-statistics.html"><a href="sample-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>3.7</b> The t-Distribution</a></li>
<li class="chapter" data-level="3.8" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.8</b> Confidence Interval</a></li>
<li class="chapter" data-level="3.9" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval-and-probability"><i class="fa fa-check"></i><b>3.9</b> Confidence Interval and Probability</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html"><i class="fa fa-check"></i><b>4</b> Two-Treatment Comparisons</a>
<ul>
<li class="chapter" data-level="4.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#side-by-side-trials"><i class="fa fa-check"></i><b>4.1</b> Side-by-Side Trials</a></li>
<li class="chapter" data-level="4.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#blocked-design"><i class="fa fa-check"></i><b>4.2</b> Blocked Design</a></li>
<li class="chapter" data-level="4.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-2"><i class="fa fa-check"></i><b>4.3</b> Case Study</a></li>
<li class="chapter" data-level="4.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#confidence-interval-1"><i class="fa fa-check"></i><b>4.4</b> Confidence Interval</a></li>
<li class="chapter" data-level="4.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test"><i class="fa fa-check"></i><b>4.5</b> T-Test</a></li>
<li class="chapter" data-level="4.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#conclusion"><i class="fa fa-check"></i><b>4.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html"><i class="fa fa-check"></i><b>5</b> Understanding Statistical Tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#research-question"><i class="fa fa-check"></i><b>5.1</b> Research Question</a></li>
<li class="chapter" data-level="5.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-model"><i class="fa fa-check"></i><b>5.2</b> The Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#treatment-effect"><i class="fa fa-check"></i><b>5.2.1</b> Treatment Effect</a></li>
<li class="chapter" data-level="5.2.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#error-effect"><i class="fa fa-check"></i><b>5.2.2</b> Error Effect</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#hypotheses"><i class="fa fa-check"></i><b>5.3</b> Hypotheses</a></li>
<li class="chapter" data-level="5.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#p-value"><i class="fa fa-check"></i><b>5.4</b> P-Value</a></li>
<li class="chapter" data-level="5.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-p-value-and-errors"><i class="fa fa-check"></i><b>5.5</b> The P-Value and Errors</a></li>
<li class="chapter" data-level="5.6" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-vs-two-sided-hypotheses"><i class="fa fa-check"></i><b>5.6</b> One-Sided vs Two-Sided Hypotheses</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html"><i class="fa fa-check"></i><b>6</b> Multiple Treatment Trials</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-3"><i class="fa fa-check"></i><b>6.1</b> Case Study</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-linear-additive-model"><i class="fa fa-check"></i><b>6.2</b> The Linear Additive Model</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#analysis-of-variance"><i class="fa fa-check"></i><b>6.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-f-statistic"><i class="fa fa-check"></i><b>6.4</b> The F statistic</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-anova-table"><i class="fa fa-check"></i><b>6.5</b> The ANOVA Table</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#source-of-variation"><i class="fa fa-check"></i><b>6.5.1</b> Source of Variation</a></li>
<li class="chapter" data-level="6.5.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#sum-of-squares-1"><i class="fa fa-check"></i><b>6.5.2</b> Sum of Squares</a></li>
<li class="chapter" data-level="6.5.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#degrees-of-freedom-1"><i class="fa fa-check"></i><b>6.5.3</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="6.5.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#mean-square"><i class="fa fa-check"></i><b>6.5.4</b> Mean Square</a></li>
<li class="chapter" data-level="6.5.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#f-value"><i class="fa fa-check"></i><b>6.5.5</b> F-Value</a></li>
<li class="chapter" data-level="6.5.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#p-value-1"><i class="fa fa-check"></i><b>6.5.6</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#visualizing-how-the-anova-table-relates-to-variance"><i class="fa fa-check"></i><b>6.6</b> Visualizing How the Anova Table Relates to Variance</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html"><i class="fa fa-check"></i><b>7</b> Multiple Treatment Designs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1</b> Randomized Complete Block Design</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1.1</b> Case Study: Randomized Complete Block Design</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design"><i class="fa fa-check"></i><b>7.2</b> Factorial Design</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-1-1"><i class="fa fa-check"></i><b>7.2.1</b> Case Study 1</a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-2-1"><i class="fa fa-check"></i><b>7.2.2</b> Case Study 2</a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#discussing-interactions"><i class="fa fa-check"></i><b>7.2.3</b> Discussing Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design"><i class="fa fa-check"></i><b>7.3</b> Split-Plot Design</a></li>
<li class="chapter" data-level="7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#linear-additive-model-3"><i class="fa fa-check"></i><b>7.4</b> Linear Additive Model</a></li>
<li class="chapter" data-level="7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#conclusion-1"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html"><i class="fa fa-check"></i><b>8</b> Means Separation and Data Presentation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-4"><i class="fa fa-check"></i><b>8.1</b> Case Study</a></li>
<li class="chapter" data-level="8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference"><i class="fa fa-check"></i><b>8.2</b> Least Significant Difference</a></li>
<li class="chapter" data-level="8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#lsd-output-in-r"><i class="fa fa-check"></i><b>8.3</b> LSD Output in R</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#statistics-table"><i class="fa fa-check"></i><b>8.3.1</b> Statistics Table</a></li>
<li class="chapter" data-level="8.3.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-table"><i class="fa fa-check"></i><b>8.3.2</b> Means Table</a></li>
<li class="chapter" data-level="8.3.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#groups-table"><i class="fa fa-check"></i><b>8.3.3</b> Groups Table</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#comparisonwise-versus-experimentwise-error"><i class="fa fa-check"></i><b>8.4</b> Comparisonwise versus Experimentwise Error</a></li>
<li class="chapter" data-level="8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>8.5</b> Tukey’s Honest Significant Difference</a></li>
<li class="chapter" data-level="8.6" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrast"><i class="fa fa-check"></i><b>8.6</b> Linear Contrast</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#coefficients"><i class="fa fa-check"></i><b>8.6.1</b> Coefficients</a></li>
<li class="chapter" data-level="8.6.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrasts-with-r"><i class="fa fa-check"></i><b>8.6.2</b> Linear Contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-presentation"><i class="fa fa-check"></i><b>8.7</b> Means Presentation</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-tables"><i class="fa fa-check"></i><b>8.7.1</b> Means Tables</a></li>
<li class="chapter" data-level="8.7.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#plotting-means"><i class="fa fa-check"></i><b>8.7.2</b> Plotting Means</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html"><i class="fa fa-check"></i><b>9</b> Messy and Missing Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-normal-distributions"><i class="fa fa-check"></i><b>9.1</b> Inspecting data for Normal Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histograms-1"><i class="fa fa-check"></i><b>9.1.1</b> Histograms</a></li>
<li class="chapter" data-level="9.1.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile-plots"><i class="fa fa-check"></i><b>9.1.2</b> Rank Percentile Plots</a></li>
<li class="chapter" data-level="9.1.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plots"><i class="fa fa-check"></i><b>9.1.3</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-equal-variances"><i class="fa fa-check"></i><b>9.2</b> Inspecting Data for Equal Variances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#mean-variance-plot"><i class="fa fa-check"></i><b>9.2.1</b> Mean-Variance Plot</a></li>
<li class="chapter" data-level="9.2.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#homogeneity-of-variance-tests"><i class="fa fa-check"></i><b>9.2.2</b> Homogeneity of Variance Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-messy-data"><i class="fa fa-check"></i><b>9.3</b> Dealing with Messy Data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#outliers"><i class="fa fa-check"></i><b>9.3.1</b> Outliers</a></li>
<li class="chapter" data-level="9.3.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#non-normal-data-and-unequal-variances"><i class="fa fa-check"></i><b>9.3.2</b> Non-normal Data and Unequal Variances</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>9.4</b> Dealing with Missing Data</a></li>
<li class="chapter" data-level="9.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#summary"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html"><i class="fa fa-check"></i><b>10</b> Correlation and Simple Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation"><i class="fa fa-check"></i><b>10.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-cucumber"><i class="fa fa-check"></i><b>10.1.1</b> Case Study: Cucumber</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation-1"><i class="fa fa-check"></i><b>10.2</b> Correlation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#how-is-r-calcuated-optional-reading"><i class="fa fa-check"></i><b>10.2.1</b> How Is r Calcuated (optional reading)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-5"><i class="fa fa-check"></i><b>10.3.1</b> Case Study</a></li>
<li class="chapter" data-level="10.3.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#linear-equation"><i class="fa fa-check"></i><b>10.3.2</b> Linear Equation</a></li>
<li class="chapter" data-level="10.3.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#calculating-the-regression-equation"><i class="fa fa-check"></i><b>10.3.3</b> Calculating the Regression Equation</a></li>
<li class="chapter" data-level="10.3.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#least-squares-estimate"><i class="fa fa-check"></i><b>10.3.4</b> Least-Squares Estimate</a></li>
<li class="chapter" data-level="10.3.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#significance-of-coefficients"><i class="fa fa-check"></i><b>10.3.5</b> Significance of Coefficients</a></li>
<li class="chapter" data-level="10.3.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#analysis-of-variance-4"><i class="fa fa-check"></i><b>10.3.6</b> Analysis of Variance</a></li>
<li class="chapter" data-level="10.3.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#measuring-model-fit-with-r-square"><i class="fa fa-check"></i><b>10.3.7</b> Measuring Model Fit with R-Square</a></li>
<li class="chapter" data-level="10.3.8" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#checking-whether-the-linear-model-is-appropriate"><i class="fa fa-check"></i><b>10.3.8</b> Checking whether the Linear Model is Appropriate</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#extrapolation"><i class="fa fa-check"></i><b>10.4</b> Extrapolation</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Nonlinear Relationships and Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#multiplie-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiplie Linear Regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-modelling-yield-by-county"><i class="fa fa-check"></i><b>11.1.1</b> Case Study: Modelling Yield by County</a></li>
<li class="chapter" data-level="11.1.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#beware-of-bloated-models"><i class="fa fa-check"></i><b>11.1.2</b> Beware of Bloated Models</a></li>
<li class="chapter" data-level="11.1.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#methods-for-avoiding-bloated-models"><i class="fa fa-check"></i><b>11.1.3</b> Methods for Avoiding Bloated Models</a></li>
<li class="chapter" data-level="11.1.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#tunning-and-comparing-models"><i class="fa fa-check"></i><b>11.1.4</b> Tunning and Comparing Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#nonlinear-relationships"><i class="fa fa-check"></i><b>11.2</b> Nonlinear Relationships</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-linear-regression"><i class="fa fa-check"></i><b>11.2.1</b> Fitting Nonlinear Responses with Linear Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-nonlinear-regression"><i class="fa fa-check"></i><b>11.2.2</b> Fitting Nonlinear Responses with Nonlinear Regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#summary-1"><i class="fa fa-check"></i><b>11.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-statistics.html"><a href="spatial-statistics.html"><i class="fa fa-check"></i><b>12</b> Spatial Statistics</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-general"><i class="fa fa-check"></i><b>12.1</b> Projection (General)</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#wgs-84-epsg-4236"><i class="fa fa-check"></i><b>12.1.1</b> WGS 84 (EPSG: 4236)</a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#mercator-epsg-3857"><i class="fa fa-check"></i><b>12.1.2</b> Mercator (EPSG: 3857)</a></li>
<li class="chapter" data-level="12.1.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#us-national-atlas-equal-area-epsg-2163"><i class="fa fa-check"></i><b>12.1.3</b> US National Atlas Equal Area (EPSG: 2163)</a></li>
<li class="chapter" data-level="12.1.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#utm-zone-11n-epsg-2955"><i class="fa fa-check"></i><b>12.1.4</b> UTM Zone 11N (EPSG: 2955)</a></li>
<li class="chapter" data-level="12.1.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-summary"><i class="fa fa-check"></i><b>12.1.5</b> Projection Summary</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#shape-files"><i class="fa fa-check"></i><b>12.2</b> Shape Files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-soybean-yield-in-iowa"><i class="fa fa-check"></i><b>12.2.1</b> Case Study: Soybean Yield in Iowa</a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#ssurgo"><i class="fa fa-check"></i><b>12.2.2</b> SSURGO</a></li>
<li class="chapter" data-level="12.2.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-with-shapes"><i class="fa fa-check"></i><b>12.2.3</b> Operations with Shapes</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#rasters"><i class="fa fa-check"></i><b>12.3</b> Rasters</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#interpolation"><i class="fa fa-check"></i><b>12.3.1</b> Interpolation</a></li>
<li class="chapter" data-level="12.3.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#kriging"><i class="fa fa-check"></i><b>12.3.2</b> Kriging</a></li>
<li class="chapter" data-level="12.3.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-on-kriged-data"><i class="fa fa-check"></i><b>12.3.3</b> Operations on Kriged Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>13</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-1"><i class="fa fa-check"></i><b>13.1</b> Machine Learning</a></li>
<li class="chapter" data-level="13.2" data-path="machine-learning.html"><a href="machine-learning.html#cluster-analyses"><i class="fa fa-check"></i><b>13.2</b> Cluster Analyses</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-grouping-midwestern-environments"><i class="fa fa-check"></i><b>13.2.1</b> Case Study: Grouping Midwestern Environments</a></li>
<li class="chapter" data-level="13.2.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling"><i class="fa fa-check"></i><b>13.2.2</b> Scaling</a></li>
<li class="chapter" data-level="13.2.3" data-path="machine-learning.html"><a href="machine-learning.html#clustering-animation"><i class="fa fa-check"></i><b>13.2.3</b> Clustering Animation</a></li>
<li class="chapter" data-level="13.2.4" data-path="machine-learning.html"><a href="machine-learning.html#county-cluster-analysis"><i class="fa fa-check"></i><b>13.2.4</b> County Cluster Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>13.3</b> k-Nearest-Neighbors</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-guessing-county-yields-based-on-environmental-similarity"><i class="fa fa-check"></i><b>13.3.1</b> Case Study: Guessing County Yields based on Environmental Similarity</a></li>
<li class="chapter" data-level="13.3.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling-1"><i class="fa fa-check"></i><b>13.3.2</b> Scaling</a></li>
<li class="chapter" data-level="13.3.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbor-animation"><i class="fa fa-check"></i><b>13.3.3</b> k-Nearest-Neighbor Animation</a></li>
<li class="chapter" data-level="13.3.4" data-path="machine-learning.html"><a href="machine-learning.html#choosing-k"><i class="fa fa-check"></i><b>13.3.4</b> Choosing <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="13.3.5" data-path="machine-learning.html"><a href="machine-learning.html#model-cross-validation"><i class="fa fa-check"></i><b>13.3.5</b> Model Cross-Validation</a></li>
<li class="chapter" data-level="13.3.6" data-path="machine-learning.html"><a href="machine-learning.html#yield-prediction-with-nearest-neighbor-analysis"><i class="fa fa-check"></i><b>13.3.6</b> Yield Prediction with Nearest Neighbor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="machine-learning.html"><a href="machine-learning.html#classification-trees"><i class="fa fa-check"></i><b>13.4</b> Classification Trees</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="machine-learning.html"><a href="machine-learning.html#features"><i class="fa fa-check"></i><b>13.4.1</b> Features</a></li>
<li class="chapter" data-level="13.4.2" data-path="machine-learning.html"><a href="machine-learning.html#quantitative-categorical-data"><i class="fa fa-check"></i><b>13.4.2</b> Quantitative (Categorical) Data</a></li>
<li class="chapter" data-level="13.4.3" data-path="machine-learning.html"><a href="machine-learning.html#quanatitiative-continuous-data"><i class="fa fa-check"></i><b>13.4.3</b> Quanatitiative (Continuous) Data</a></li>
<li class="chapter" data-level="13.4.4" data-path="machine-learning.html"><a href="machine-learning.html#overfitting-1"><i class="fa fa-check"></i><b>13.4.4</b> Overfitting</a></li>
<li class="chapter" data-level="13.4.5" data-path="machine-learning.html"><a href="machine-learning.html#cross-validation-1"><i class="fa fa-check"></i><b>13.4.5</b> Cross Validation</a></li>
<li class="chapter" data-level="13.4.6" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>13.4.6</b> Random Forest</a></li>
<li class="chapter" data-level="13.4.7" data-path="machine-learning.html"><a href="machine-learning.html#feature-importance"><i class="fa fa-check"></i><b>13.4.7</b> Feature Importance</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="machine-learning.html"><a href="machine-learning.html#summary-2"><i class="fa fa-check"></i><b>13.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>14</b> Putting it all Together</a>
<ul>
<li class="chapter" data-level="14.1" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-1-yield-map-population-summary-and-z-distribution"><i class="fa fa-check"></i><b>14.1</b> Scenario 1: Yield Map (Population Summary and Z-Distribution)</a></li>
<li class="chapter" data-level="14.2" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-2-yield-estimate-sampling-t-distribution"><i class="fa fa-check"></i><b>14.2</b> Scenario 2: Yield Estimate (Sampling t-Distribution)</a></li>
<li class="chapter" data-level="14.3" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-3-side-by-side-t-test"><i class="fa fa-check"></i><b>14.3</b> Scenario 3: Side-By-Side (t-Test)</a></li>
<li class="chapter" data-level="14.4" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-4-fungicide-trial-anova-crd-or-rcbd"><i class="fa fa-check"></i><b>14.4</b> Scenario 4: Fungicide Trial (ANOVA CRD or RCBD)</a></li>
<li class="chapter" data-level="14.5" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-5-hybrid-response-to-fungicide-trial-anova-factorial-or-split-plot"><i class="fa fa-check"></i><b>14.5</b> Scenario 5: Hybrid Response to Fungicide Trial (ANOVA Factorial or Split Plot)</a></li>
<li class="chapter" data-level="14.6" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-6-foliar-rate-response-trial-linear-or-non-linear-regression"><i class="fa fa-check"></i><b>14.6</b> Scenario 6: Foliar Rate-Response Trial (Linear or Non-Linear Regression)</a></li>
<li class="chapter" data-level="14.7" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-7-application-map-shapefiles-and-rasters"><i class="fa fa-check"></i><b>14.7</b> Scenario 7: Application Map (Shapefiles and Rasters)</a></li>
<li class="chapter" data-level="14.8" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-8-yield-prediction-multiple-linear-regression-and-other-predictive-models"><i class="fa fa-check"></i><b>14.8</b> Scenario 8: Yield Prediction (Multiple Linear Regression and other Predictive Models)</a></li>
<li class="chapter" data-level="14.9" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#summary-3"><i class="fa fa-check"></i><b>14.9</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Agricultural Professionals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="messy-and-missing-data" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Messy and Missing Data</h1>
<p>You have to love the nice, complete datasets I have served up to you in this and other statistics texts. Indeed, some trials will work out this way – in general, the simpler the treatment (and the technology used to apply it) the greater your chances of a complete dataset. Planters will jam, nozzles will plug, and if a trial has 12 treatments a couple of them may end up in the wrong plot. Best to avoid those if possible.</p>
<p>As well, the smaller the experiment, or the more controlled the environment, the greater your odds of a complete dataset. For that reason, decades of university and industry research has been performed in 10- x 40- plots stacked closely together on manicured, table-top-flat ground. If you were a seed-breeder, you had dibs on these fields. If you were an ecologist like me, you might have to head to the back 40 (j/k).</p>
<p>If you can farm in your head or your basement, drop me a note and I will exempt you, with envy from this unit. For those of us who farm by the acre or section, however, the issue of data quality is an agonizing and sometimes subjective topic – but critical. Remember, most of our statistics are models, and the saying goes: “junk in, junk out.” Your models are only as good as the data you use to build them.</p>
<p>Part of your job as a researcher or end-user of any data, before you conduct or read the results from any test, is to ask yourself – are the data reliable enough to support the inferences? A trial with wildly-different experimental units may bias results – if all the replicates of one treatment end up in the better units and others are concentrated in the poorer ones. You may falsely recommend a product if you don’t catch this.</p>
<p>At the other extreme, the failure conduct research on similar experimental units will introduce background variance (or noise) that prevents a statistical test from concluding a difference is not the result of chance, even though the treatments are, in fact, different. In that case, you may fail to introduce – or adopt – a product or technology with real promise.</p>
<p>In this unit, we will first learn ways to inspect datasets for extreme values which, even given the inherent variability of data, may be suspect. Boxplots, histograms, and probability plots will be our tools for these exercises.</p>
<p>We will then address the uncomfortable question of what to do when we have missing data, either because a plot was compromised during the trial, or because we rejected that plot because its extreme value.</p>
<div id="inspecting-data-for-normal-distributions" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Inspecting data for Normal Distributions</h2>
<p>I know, I know, it is so exciting to have data! The hard physical work of the research is done, the data is painstakingly entered into Excel. Let’s run the ANOVAs and regressions now – if we hurry we can still make it to happy hour!</p>
<p>It is so tempting to jump right into deep analyses as the data roll in. But it is important to realize these analyses are based on assumptions:</p>
<ul>
<li>That the observations for each treatment level are normally distributed around the treatment mean</li>
<li>That the variance or spread of observations around each level of treatment is roughly equal.</li>
<li>That experimental units are comparable among treatment levels, so that the treatment and error effects are appropriately separated.</li>
</ul>
<p>It is very possible, based on the nature of trials, that one or more of these assumptions may be violated. If you have ever counted weeds in a herbicide trial, you have noted that well-treated plots have weed counts that are consistently near zero – but that weedy checks have wildly variable counts (100, 200, 300 weeds). Growth analysis (where plants of different sizes are measured) is also prone to messy data issues, because variance in measurements increases numerically as plants grow. Experimental units (plots) in both commercial and research farm fields can vary because of prior management unknown to the researcher.</p>
<div id="histograms-1" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Histograms</h3>
<p>In the very first unit of this course Unit 2, you were introduced to the histogram. Recall the histogram is a vertical bar chart in which the width of bars defines the different ranges into which observations are grouped, and the height represents the count or proportion of observations falling into each range.</p>
<p>In the data below, we have a dataset with 500 observations of corn yield. The mean is approximately 180. We can see the data distribution is approximately normal.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="messy-and-missing-data.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb215-2"><a href="messy-and-missing-data.html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(fGarch)</span></span>
<span id="cb215-3"><a href="messy-and-missing-data.html#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb215-4"><a href="messy-and-missing-data.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">082720</span>)</span>
<span id="cb215-5"><a href="messy-and-missing-data.html#cb215-5" aria-hidden="true" tabindex="-1"></a>norm_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">obs_value =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="at">mean=</span><span class="dv">180</span>, <span class="at">sd=</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb215-6"><a href="messy-and-missing-data.html#cb215-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">dataset=</span><span class="st">&quot;normal&quot;</span>)</span>
<span id="cb215-7"><a href="messy-and-missing-data.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(5)</span></span>
<span id="cb215-8"><a href="messy-and-missing-data.html#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="co"># skewed_data = data.frame(obs_value = rsnorm(1000, mean = 20, sd = 10, xi = 100)) %&gt;%</span></span>
<span id="cb215-9"><a href="messy-and-missing-data.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="co">#         mutate(dataset=&quot;skewed&quot;)</span></span>
<span id="cb215-10"><a href="messy-and-missing-data.html#cb215-10" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb215-11"><a href="messy-and-missing-data.html#cb215-11" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_and_skewed = rbind(norm_data, skewed_data) %&gt;%</span></span>
<span id="cb215-12"><a href="messy-and-missing-data.html#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame() %&gt;%</span></span>
<span id="cb215-13"><a href="messy-and-missing-data.html#cb215-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(obs_value&gt;0)</span></span>
<span id="cb215-14"><a href="messy-and-missing-data.html#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb215-15"><a href="messy-and-missing-data.html#cb215-15" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb215-16"><a href="messy-and-missing-data.html#cb215-16" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(norm_and_skewed, &quot;data/norm_and_skewed.csv&quot;, row.names = FALSE)</span></span>
<span id="cb215-17"><a href="messy-and-missing-data.html#cb215-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-18"><a href="messy-and-missing-data.html#cb215-18" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_and_skewed = read.csv(&quot;data/norm_and_skewed.csv&quot;)</span></span>
<span id="cb215-19"><a href="messy-and-missing-data.html#cb215-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-20"><a href="messy-and-missing-data.html#cb215-20" aria-hidden="true" tabindex="-1"></a>norm_data <span class="sc">%&gt;%</span></span>
<span id="cb215-21"><a href="messy-and-missing-data.html#cb215-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># filter(dataset==&quot;normal&quot;) %&gt;%</span></span>
<span id="cb215-22"><a href="messy-and-missing-data.html#cb215-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb215-23"><a href="messy-and-missing-data.html#cb215-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">160</span>,<span class="dv">200</span>,<span class="dv">2</span>), <span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>The summary data are shown below. We can see that the median and mean are both approximately 180 bushels per acre. We can also see the 1st and 3rd quantiles (equal to the 25th and 75th percentiles) are a little over three bushels from the median. The minimum and maximum observations are also similarly spaced from the median.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="messy-and-missing-data.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(norm_data<span class="sc">$</span>obs_value)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   161.5   176.9   180.0   180.2   183.4   194.1</code></pre>
<p>When we are dealing with data such as pest counts, our data may be non-normal. Rather than being symmetrical, the data may be skewed to one side or another. For example, in the dataset below, total velvetleaf dry weight in grams per square meter was measured. If you have worked like me with weed populations, you realize weed competitiveness is all about outracing the crop to the sun. If the weed loses, which it will in most cases, it will be small. But the proud few weeds who beat the crop will be huge. That is reflected in the data below.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="messy-and-missing-data.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fGarch)</span></code></pre></div>
<pre><code>## Loading required package: timeDate</code></pre>
<pre><code>## 
## Attaching package: &#39;timeDate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:agricolae&#39;:
## 
##     kurtosis, skewness</code></pre>
<pre><code>## Loading required package: timeSeries</code></pre>
<pre><code>## Loading required package: fBasics</code></pre>
<pre><code>## 
## Attaching package: &#39;fBasics&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:muStat&#39;:
## 
##     stdev</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="messy-and-missing-data.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb226-2"><a href="messy-and-missing-data.html#cb226-2" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">obs_value =</span> <span class="fu">rsnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">4</span>, <span class="at">xi =</span> <span class="dv">50</span>)) </span>
<span id="cb226-3"><a href="messy-and-missing-data.html#cb226-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-4"><a href="messy-and-missing-data.html#cb226-4" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="sc">%&gt;%</span></span>
<span id="cb226-5"><a href="messy-and-missing-data.html#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb226-6"><a href="messy-and-missing-data.html#cb226-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">binwidth =</span> <span class="dv">1</span>) </span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>When we look at the histogram, the data are skewed to the right. The histogram is not symmetrical.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="messy-and-missing-data.html#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(velvetleaf_skewed<span class="sc">$</span>obs_value)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.7237  2.7993  5.1859  6.0021  8.5883 23.7734</code></pre>
<p>When we look at the summary data, we first notice the mean and median are different. For a dataset this size (1000 observations, we would expect them to be more similar.) We notice that the first quantile is closer to the median than the third quantile. The greatest indication the data is skewed, however, is is that the minimum is about 4 plants less than the median, while the maximum is about 18 plants greater.</p>
<p>Data like this may be transformed (mathematically re-scaled) so that it is more normal for analyses. We will cover this below.</p>
</div>
<div id="rank-percentile-plots" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Rank Percentile Plots</h3>
<p>Another way to inspect the normality of datasets is to use a rank percentile plot. This plot uses the percentile rank of each observation, from lowest to highest, as the x-value of each point. The y-value of the point is its observed value.</p>
<p>The data for our normally-distributed corn yield dataset are plotted in the rank percentile plot below. Normally-distributed data tend to be strongly linear in the middle of the plot. If we draw a regression line through the plot, you can see most of the data are close to that line. The lowest percentile points fall below the line. That means they are a little lower in value than the normal distribution function might predict. The opposite is true of the highest percentile points. This indicates our distribution is a little bit wider than normal, but not enough that we cannot use it for analysis.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="messy-and-missing-data.html#cb229-1" aria-hidden="true" tabindex="-1"></a>norm_data <span class="sc">%&gt;%</span></span>
<span id="cb229-2"><a href="messy-and-missing-data.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">percent_rank</span>(obs_value)) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="messy-and-missing-data.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rank, <span class="at">y=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb229-4"><a href="messy-and-missing-data.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>Our skewed data, however, shows up quite differently in the rank percentile plot. We can see that most of the data closely fit a line. But starting around the 75th percentile, the observed values are much greater than the predicted values – almost twice as much. This means the distribution is much wider to the right of the distribution curve than to the left, and that the data are non-normal</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="messy-and-missing-data.html#cb230-1" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="messy-and-missing-data.html#cb230-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">percent_rank</span>(obs_value)) <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="messy-and-missing-data.html#cb230-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rank, <span class="at">y=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb230-4"><a href="messy-and-missing-data.html#cb230-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-157-1.png" width="672" /></p>
</div>
<div id="box-plots" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Box Plots</h3>
<p>The first two methods I have shown you, the histogram and rank percentile plots, are useful if you have a few treatments with a large number of replicates. They are taught in every statistics course and you should know about them. But, in my experience, they are not useful if you have a trial with fewer replications. A normal distribution is not going to appear in a histogram if you only have four replicates – instead you will just see the four individual measurements.</p>
<p>Box plots, on the other hand, are very useful for inspecting multiple treatments. In the plot below, boxplots for four corn treatments are shown. The treatments are labeled A, B, C, and D. The data are plotted so their treatments are listed along the vertical axis, and their values are listed along the y-axis.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="messy-and-missing-data.html#cb231-1" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">trt =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">each=</span><span class="dv">4</span>),</span>
<span id="cb231-2"><a href="messy-and-missing-data.html#cb231-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mean =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">170</span>,<span class="dv">180</span>,<span class="dv">190</span>), <span class="at">each=</span><span class="dv">4</span>)) </span>
<span id="cb231-3"><a href="messy-and-missing-data.html#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="messy-and-missing-data.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">082720</span>)</span>
<span id="cb231-5"><a href="messy-and-missing-data.html#cb231-5" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="ot">=</span> norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb231-6"><a href="messy-and-missing-data.html#cb231-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb231-7"><a href="messy-and-missing-data.html#cb231-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> mean <span class="sc">+</span> error) <span class="sc">%&gt;%</span></span>
<span id="cb231-8"><a href="messy-and-missing-data.html#cb231-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create outlier</span></span>
<span id="cb231-9"><a href="messy-and-missing-data.html#cb231-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">8</span>, <span class="dv">195</span>, yield))</span>
<span id="cb231-10"><a href="messy-and-missing-data.html#cb231-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-11"><a href="messy-and-missing-data.html#cb231-11" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb231-12"><a href="messy-and-missing-data.html#cb231-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb231-13"><a href="messy-and-missing-data.html#cb231-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb231-14"><a href="messy-and-missing-data.html#cb231-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb231-15"><a href="messy-and-missing-data.html#cb231-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb231-16"><a href="messy-and-missing-data.html#cb231-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<p>The boxplots help us understand the distribution of the data. Lets start with the box, which tells about the spread of the data. The left side of the box is the 25th percentile, the line in the middle is the 50th percentile (or median), and the right side of the box is the 75th percentile. So the box shows us the spread of the middle half of the observations for each treatment.</p>
<p>The diamond shown within the box is the mean. In a normal distribution, the median and mean should be close.</p>
<p>The lines extending from the left and right side of the box are called whiskers. The whiskers extend to the lowest and highest observations for a treatment. The whiskers extend no more more than 1.5 times the <em>inter-quartile range</em>, which for the lower whisker is the the difference between the 25th and 50th percentiles, and for the upper whisker is the difference between the 50th and 75th percentiles.</p>
<p>In treatment B, we can see the upper whisker is missing, and instead there is a point to the right of the bar. If an observation is beyond 1.5 times the interquartile range, the whisker is not shown and the observation is instead represented by a point. This observation is called an <em>outlier</em>, meaning that it outside the range of values expected in a normal distribution. We will talk more about outliers in the next section.</p>
<p>The boxplot tells us something beyond the distribution of the individual treatments. If the boxes are markedly different in their width, the data may have substantially different variances. We should investigate these further using a <em>mean-variance plot</em>, and perhaps a statistical <em>test of heterogeneity</em>.</p>
</div>
</div>
<div id="inspecting-data-for-equal-variances" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Inspecting Data for Equal Variances</h2>
<p>So far, we have learned to use the t-test and analysis of variance to test named treatments (that is, hybrids, management practices, and other products that can be described by name). These tests generally assume not only that observed values are normally distributed, but that the variances are approximately equal among the different treatments in our experiment. If the variances are unequal, we may calculate least significant differences (LSDs) or honest significant differences (HSDs) that are inappropriate. Among treatments that have smaller variances, our LSD or HSD may be overestimated; among treatments that have larger variances, the LSD or HSD may be underestimated.</p>
<p>The visual inspection of individual treatment distributions in the box plot above, followed by a scatter plot of the treatment variances versus their means, can give us a visual sense of unequal variances. These suspicions can then be tested using a Test for Homogeneity that calculates the probability of differences in variances as greater as those observed.</p>
<div id="mean-variance-plot" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Mean-Variance Plot</h3>
<p>In a mean-variance plot, the treatment means are plotted along the horizontal axis and the variances are plotted along the vertical axis. The plot for the corn yield dataset we have used so far is shown below.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="messy-and-missing-data.html#cb232-1" aria-hidden="true" tabindex="-1"></a>norm_stats <span class="ot">=</span> norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb232-2"><a href="messy-and-missing-data.html#cb232-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb232-3"><a href="messy-and-missing-data.html#cb232-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb232-4"><a href="messy-and-missing-data.html#cb232-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb232-5"><a href="messy-and-missing-data.html#cb232-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb232-6"><a href="messy-and-missing-data.html#cb232-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-7"><a href="messy-and-missing-data.html#cb232-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-8"><a href="messy-and-missing-data.html#cb232-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb232-9"><a href="messy-and-missing-data.html#cb232-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
<p>We can see the variance of treatment B is many times greater than that of the other treatments. In general, we like to see the variances differ by no more than a factor of 2.</p>
<p>In cases where we are dealing with populations that either “thrive or die” based on environment – particularly pest populations – we may see relationships between the mean and variance. Pest count data is often like this. In our velvetleaf counts, for example, we might find that our greater treatment means are also associated with greater variations in counts between plots.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="messy-and-missing-data.html#cb233-1" aria-hidden="true" tabindex="-1"></a>rnorm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd) { mean<span class="sc">+</span>sd<span class="sc">*</span><span class="fu">scale</span>(<span class="fu">rnorm</span>(n)) }</span>
<span id="cb233-2"><a href="messy-and-missing-data.html#cb233-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rnorm2</span>(<span class="dv">100</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb233-3"><a href="messy-and-missing-data.html#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r)  <span class="do">## 4</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="messy-and-missing-data.html#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(r)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="messy-and-missing-data.html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb237-2"><a href="messy-and-missing-data.html#cb237-2" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)),</span>
<span id="cb237-3"><a href="messy-and-missing-data.html#cb237-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">B =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="fu">sqrt</span>(<span class="dv">6</span>)),</span>
<span id="cb237-4"><a href="messy-and-missing-data.html#cb237-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">C =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">15</span>, <span class="fu">sqrt</span>(<span class="dv">10</span>)),</span>
<span id="cb237-5"><a href="messy-and-missing-data.html#cb237-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">D =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">20</span>, <span class="fu">sqrt</span>(<span class="dv">14</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb237-6"><a href="messy-and-missing-data.html#cb237-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, yield)</span>
<span id="cb237-7"><a href="messy-and-missing-data.html#cb237-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-8"><a href="messy-and-missing-data.html#cb237-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-9"><a href="messy-and-missing-data.html#cb237-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-10"><a href="messy-and-missing-data.html#cb237-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb237-11"><a href="messy-and-missing-data.html#cb237-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-12"><a href="messy-and-missing-data.html#cb237-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-13"><a href="messy-and-missing-data.html#cb237-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-14"><a href="messy-and-missing-data.html#cb237-14" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var <span class="sc">%&gt;%</span></span>
<span id="cb237-15"><a href="messy-and-missing-data.html#cb237-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb237-16"><a href="messy-and-missing-data.html#cb237-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb237-17"><a href="messy-and-missing-data.html#cb237-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb237-18"><a href="messy-and-missing-data.html#cb237-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb237-19"><a href="messy-and-missing-data.html#cb237-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
<p>In this case, the mean-variance plot may show a linear relationship between variance and mean.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="messy-and-missing-data.html#cb238-1" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var_stats <span class="ot">=</span> norm_data_prop_var <span class="sc">%&gt;%</span></span>
<span id="cb238-2"><a href="messy-and-missing-data.html#cb238-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb238-3"><a href="messy-and-missing-data.html#cb238-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb238-4"><a href="messy-and-missing-data.html#cb238-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb238-5"><a href="messy-and-missing-data.html#cb238-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb238-6"><a href="messy-and-missing-data.html#cb238-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-7"><a href="messy-and-missing-data.html#cb238-7" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var_stats <span class="sc">%&gt;%</span></span>
<span id="cb238-8"><a href="messy-and-missing-data.html#cb238-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb238-9"><a href="messy-and-missing-data.html#cb238-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-161-1.png" width="672" /></p>
<p>Finally, we may observe a dataset in which the distributions not only increase with means, but seem to do so exponentially.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="messy-and-missing-data.html#cb239-1" aria-hidden="true" tabindex="-1"></a>rnorm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd) { mean<span class="sc">+</span>sd<span class="sc">*</span><span class="fu">scale</span>(<span class="fu">rnorm</span>(n)) }</span>
<span id="cb239-2"><a href="messy-and-missing-data.html#cb239-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rnorm2</span>(<span class="dv">100</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb239-3"><a href="messy-and-missing-data.html#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r)  <span class="do">## 4</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="messy-and-missing-data.html#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(r)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="messy-and-missing-data.html#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb243-2"><a href="messy-and-missing-data.html#cb243-2" aria-hidden="true" tabindex="-1"></a>norm_data_prop_sd <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="fl">0.3</span>),</span>
<span id="cb243-3"><a href="messy-and-missing-data.html#cb243-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">B =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="fl">2.5</span>),</span>
<span id="cb243-4"><a href="messy-and-missing-data.html#cb243-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">C =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">15</span>, <span class="fl">4.7</span>),</span>
<span id="cb243-5"><a href="messy-and-missing-data.html#cb243-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">D =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">20</span>, <span class="fl">6.9</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb243-6"><a href="messy-and-missing-data.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, yield)</span>
<span id="cb243-7"><a href="messy-and-missing-data.html#cb243-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-8"><a href="messy-and-missing-data.html#cb243-8" aria-hidden="true" tabindex="-1"></a>norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb243-9"><a href="messy-and-missing-data.html#cb243-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb243-10"><a href="messy-and-missing-data.html#cb243-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb243-11"><a href="messy-and-missing-data.html#cb243-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-12"><a href="messy-and-missing-data.html#cb243-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb243-13"><a href="messy-and-missing-data.html#cb243-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>In this case, the mean-variance plot may show a curved relationship between variance and mean.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="messy-and-missing-data.html#cb244-1" aria-hidden="true" tabindex="-1"></a>s_norm_stats <span class="ot">=</span> norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb244-2"><a href="messy-and-missing-data.html#cb244-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb244-3"><a href="messy-and-missing-data.html#cb244-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb244-4"><a href="messy-and-missing-data.html#cb244-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield),</span>
<span id="cb244-5"><a href="messy-and-missing-data.html#cb244-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">sd=</span><span class="fu">sd</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb244-6"><a href="messy-and-missing-data.html#cb244-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb244-7"><a href="messy-and-missing-data.html#cb244-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-8"><a href="messy-and-missing-data.html#cb244-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-9"><a href="messy-and-missing-data.html#cb244-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>s_norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb244-10"><a href="messy-and-missing-data.html#cb244-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<p>We may want to check whether the standard deviation has a more linear relationship to mean.</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="messy-and-missing-data.html#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>s_norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb245-2"><a href="messy-and-missing-data.html#cb245-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-164-1.png" width="672" />
The largest mean has a significant difference of 6.9, while the smallest mean has a significant difference of 0.3. In other words, the largest significant difference is 23 times the smallest significant difference.</p>
</div>
<div id="homogeneity-of-variance-tests" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Homogeneity of Variance Tests</h3>
<p>In previous units, we learned how to compare two variances – using the F-test. In the Analysis of Variance, we tested whether the variance among treatment means was greater than the variance within treatments. If the treatment variance was sufficiently greater than the error variance, we concluded the treatment effect explained a significant amount of the variation in observed values.</p>
<p>In this unit, we want to do something similar – we want to compare the variances associated with multiple treatments to see if they are significantly different. When data are normally-distributed, the method for comparing multiple variances is <em>Bartlett’s Test</em>. (If you continue your statistical travels, you may come across Levene’s Test, but that is for non-normal data.)</p>
<p>Bartlett’s test, as best as I can tell (the formula is awful and no one seems willing to explain it), acts like a sum of squares for variances, comparing the variances of the individual treatments to their mean when pooled together. This is an incomplete explanation, but I hope it will satisfy the curious. Fortunately for us, the test is easy to implement in R and the output simple.</p>
<p>If we run Bartlett’s test on our corn data above, we get the following results.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="messy-and-missing-data.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(yield<span class="sc">~</span>trt, norm_data_mult_trts)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  yield by trt
## Bartlett&#39;s K-squared = 6.0302, df = 3, p-value = 0.1102</code></pre>
<p>Let’s go through the output. “Bartlett’s K-squared” is the statistic produced by the nasty formula I referenced above. Don’t worry about that. The degrees of freedom refers to the four treatments whose variances we are comparing. Most important, of course, is our p-value. There are many opinions on when to transform data – but I would recommend against transforming data unless the –value is less than 0.01. I would also recommend running your data on both the transformed and untransformed data and comparing results. If transformation does not change your inferences, then skip it.</p>
<p>Here is the Bartlett’s test on our velevleaf data where the mean and standard deviation were linearly related:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="messy-and-missing-data.html#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(yield<span class="sc">~</span>trt, norm_data_prop_sd)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  yield by trt
## Bartlett&#39;s K-squared = 14.217, df = 3, p-value = 0.002625</code></pre>
<p>In this case, we will want to analyze both the transformed and untransformed data before deciding which to us for our final inferences.</p>
</div>
</div>
<div id="dealing-with-messy-data" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Dealing with Messy Data</h2>
<p>Dealing with messy data is one of the more uncomfortable aspects of statistics, but also one of the most important. Our tests and summary statistics are based on assumptions. For tests, we assume the data are from a populations that have approximately normal distributions. We also assume they have variances that are equal – otherwise our mean separation tests will fail.</p>
<p>And finally, and this is a concept that I learned just while writing this: the validity of our inferences is based on the assumption that our samples represent the population that we are studying. Which brings us back to outliers.</p>
<div id="outliers" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Outliers</h3>
<p>Outliers can have a powerful effect in skewing data. Particularly in smaller datasets (i.e. fewer than 10 replicates per treatment), an outlier can have noticeable effects on a distribution’s normality and its variance. In regression analyses, one outlier can significantly change the slope of the model.</p>
<p>Does this mean that outliers should be omitted from the dataset? Not necessarily – first we should inspect the data more closely. The outlier might be a mistake in recording a measurement. It could be an inconsistent scale in a combine. These would be experimental errors that mean the outlier is an <em>artifact</em> of our methods, rather than a representative sample from our population. In that case, we may want to remove that observation from our dataset.</p>
<p>But investigating the outlier may also include examining the location where it was taken. This can be difficult if you are not the primary researcher and on-site where the data were gathered. But if you can overlay your plot map with a soils map, or work with aerial imagery, or examine as-applied maps, you may be able to identify differences in environment or management that caused a dramatic difference in the observed value.</p>
<p>In such a case, you may decide that plot did not represent the environment about which you were trying to draw inferences, and choose to omit it from the dataset. At the same time, however, knowing that the outlier’s environment or management had a dramatic effect on its performance, you may generate new hypotheses about that product. In fact, you may learn more from your outlier, through the new research it inspires, than you do from the original experiment.</p>
<p>Also, before removing an outlier, it is a good idea to run your tests with and without it to see whether it changes your conclusions. When you run your model, look at the standardized residuals. How many standard errors is the outlier from the predicted value? As a rule, if an observed value is more than two standard deviations from the predicted value, I scrutinize it before allowing it into the final analysis.</p>
<p>If you are comparing different treatments, does it change the significance of tests or differences among treatments? If you are generating a regression model, does the change in slope have a dramatic effect on the values you will predict? Will the change in slope have a dramatic effect on grower inputs and cost, or will the effect be more modest?</p>
<p>These are important questions, because as uncomfortable as it is to identify and/or remove outliers, working with incomplete datasets can be even nastier. If the statistical significance of tests or means separations are not affected by the outlier, it is best to leave it in the dataset if possible, especially if treatment replications are limited.</p>
</div>
<div id="non-normal-data-and-unequal-variances" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Non-normal Data and Unequal Variances</h3>
<p>Above, we discussed two other problems with data: data that were skewed (or non-normal) and therefore could not be modelled based on the normal distribution, and data were treatment variances were not equal – they were, in statistical terminology, they suffered from <em>heterogeneity of variances</em>.</p>
<p>Both issues can arise out of trials where observation values vary widely: counts that include rare events or where one treatment (like a check plot) can “blow up” and have a huge value. Growth studies, where size increases occur at exponential rates, are another.</p>
<p>These two issues may be similarly addressed by transforming the data. When we transform data, we use a different measuring system to rescale it. The easiest example of rescaling data is pH. Recall pH is the concentration of hydrogen atoms in a solution. This concentration can range from <span class="math inline">\(0\)</span> to <span class="math inline">\(10^{-14}\)</span></p>
<p>So when is the last time you read that your soil pH was <span class="math inline">\(6.5 \times 10^{-6}\)</span> ? You wouldnt. We commonly speak of pH as ranging from 1 (highly acidic) through 7 (neutral) to 14 (highly basic). Your are used to using the logarithmic scale(10, 1, 0.10, 0.010), rather than the arithmatic scale (1,2,3,4,5). The decibel scale for sound and the Richter scale for earthquakes also use the logarithmic scale.</p>
<div id="natural-logarithm" class="section level4" number="9.3.2.1">
<h4><span class="header-section-number">9.3.2.1</span> Natural Logarithm</h4>
<p>There are several ways to transform data, but the one I have most-often used is the natural logarithm
The natural logaritm transformation is often used when we are working with data that have a wide range of values. What constitutes a wide range of values? Think growth analysis, or counts of common events (for example, weed counts in a herbicide trial that includes treatments that vary widely in effectiveness). In these trials, it is not uncommon for observed values to vary by two or more orders of magnitude (powers of 10).</p>
<p>Our process for working with transformed data is as follows:</p>
<ul>
<li>Transform the original observations to their natural logs.<br />
</li>
<li>Calculate the ANOVA</li>
<li>Cacluate treatment means using transformed data</li>
<li>Back-transform the treatment means to the original measurement scale so they are more intuitive to users</li>
</ul>
<p>Lets work with our velvetleaf data above. Below is the analysis of variance and means separation using the least significant difference test.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="messy-and-missing-data.html#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb250-2"><a href="messy-and-missing-data.html#cb250-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-3"><a href="messy-and-missing-data.html#cb250-3" aria-hidden="true" tabindex="-1"></a>vleaf_model_before <span class="ot">=</span> <span class="fu">aov</span>(yield<span class="sc">~</span>trt, norm_data_prop_sd)</span>
<span id="cb250-4"><a href="messy-and-missing-data.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vleaf_model_before)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## trt          3  500.0  166.67   8.767 0.00237 **
## Residuals   12  228.1   19.01                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="messy-and-missing-data.html#cb252-1" aria-hidden="true" tabindex="-1"></a>lsd_before <span class="ot">=</span> <span class="fu">LSD.test</span>(vleaf_model_before, <span class="st">&quot;trt&quot;</span>)</span>
<span id="cb252-2"><a href="messy-and-missing-data.html#cb252-2" aria-hidden="true" tabindex="-1"></a>lsd_before<span class="sc">$</span>groups</span></code></pre></div>
<pre><code>##   yield groups
## D    20      a
## C    15     ab
## B    10     bc
## A     5      c</code></pre>
<p>The treatment effect is significant, and some of the treatments are significantly different from each other, but there are also noticeable overlaps.</p>
<p>Now let’s transform the data using the natural log. The original and transformed data are show below.</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="messy-and-missing-data.html#cb254-1" aria-hidden="true" tabindex="-1"></a>vleaf_log <span class="ot">=</span> norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb254-2"><a href="messy-and-missing-data.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_yield =</span> <span class="fu">log</span>(yield))</span>
<span id="cb254-3"><a href="messy-and-missing-data.html#cb254-3" aria-hidden="true" tabindex="-1"></a>vleaf_log</span></code></pre></div>
<pre><code>##    trt     yield log_yield
## 1    A  5.164436  1.641796
## 2    A  5.046640  1.618723
## 3    A  4.563925  1.518183
## 4    A  5.224999  1.653455
## 5    B  9.236621  2.223176
## 6    B 10.956095  2.393896
## 7    B 12.839163  2.552500
## 8    B  6.968121  1.941346
## 9    C  8.564738  2.147654
## 10   C 15.867385  2.764266
## 11   C 19.858115  2.988613
## 12   C 15.709762  2.754282
## 13   D 10.384946  2.340357
## 14   D 23.843831  3.171526
## 15   D 19.807285  2.986050
## 16   D 25.963938  3.256709</code></pre>
<p>Now when we run our Bartlett’s test, we see the p-value is 0.09 – there is no longer a significant difference among the treatment variances.</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="messy-and-missing-data.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(log_yield<span class="sc">~</span>trt, vleaf_log)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  log_yield by trt
## Bartlett&#39;s K-squared = 6.7935, df = 3, p-value = 0.07878</code></pre>
<p>The largest standard deviation is still 6.5 times the smallest standard deviation – but the difference has decreased dramatically. When we run our analysis of variance, we see that our p-value has decreased by several orders of magniture.</p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="messy-and-missing-data.html#cb258-1" aria-hidden="true" tabindex="-1"></a>vleaf_model_after <span class="ot">=</span> <span class="fu">aov</span>(log_yield<span class="sc">~</span>trt, vleaf_log)</span>
<span id="cb258-2"><a href="messy-and-missing-data.html#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vleaf_model_after)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## trt          3  3.995  1.3316   14.24 0.000294 ***
## Residuals   12  1.122  0.0935                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>When we run our LSD test, we notice more significant differences among the means, especially treatments A and B, which were associated with lower treatment means.</p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="messy-and-missing-data.html#cb260-1" aria-hidden="true" tabindex="-1"></a>lsd_after <span class="ot">=</span> <span class="fu">LSD.test</span>(vleaf_model_after, <span class="st">&quot;trt&quot;</span>)</span>
<span id="cb260-2"><a href="messy-and-missing-data.html#cb260-2" aria-hidden="true" tabindex="-1"></a>lsd_after<span class="sc">$</span>groups</span></code></pre></div>
<pre><code>##   log_yield groups
## D  2.938660      a
## C  2.663704     ab
## B  2.277729      b
## A  1.608039      c</code></pre>
<p>Our last step is to back-transform the means from our LSD test.</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="messy-and-missing-data.html#cb262-1" aria-hidden="true" tabindex="-1"></a>back_transformed_means <span class="ot">=</span> lsd_after<span class="sc">$</span>groups <span class="sc">%&gt;%</span></span>
<span id="cb262-2"><a href="messy-and-missing-data.html#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;treatment&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb262-3"><a href="messy-and-missing-data.html#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">exp</span>(log_yield))</span>
<span id="cb262-4"><a href="messy-and-missing-data.html#cb262-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-5"><a href="messy-and-missing-data.html#cb262-5" aria-hidden="true" tabindex="-1"></a>back_transformed_means <span class="sc">%&gt;%</span></span>
<span id="cb262-6"><a href="messy-and-missing-data.html#cb262-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(treatment, yield, groups)</span></code></pre></div>
<pre><code>##   treatment     yield groups
## 1         D 18.890521      a
## 2         C 14.349335     ab
## 3         B  9.754507      b
## 4         A  4.993011      c</code></pre>
<p>In the above table, we have back-transformed the means in our LSD table to their original scale.</p>
</div>
</div>
</div>
<div id="dealing-with-missing-data" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Dealing with Missing Data</h2>
<p>Missing data can be very problematic. Whether missing data are the result of deleting outliers, or plots lost to weather or human damage, there are three options:</p>
<ul>
<li>Drop the treatment entirely from the dataset</li>
<li>Drop one observation from each of the other treatments; if a Randomized Complete Block Design was used, delete and entire block</li>
<li>Predict the value for the plot that was omitted or lost</li>
</ul>
<p>As you see, these are ugly choices to make. If you drop the treatment entirely from the dataset, you lose all ability to test it agaist the other treatments. If you drop other replicates or the remainder of a block, you retain all treatments but reduce the degrees of freedom for statistical tests, rendering them less sensitive.</p>
<p>The third option, predicting the value that is missing, comes with its own challenges. The missing value for a plot is generally calculated using the linear additive model. For a completely randomized design, the linear model is:</p>
<p><span class="math display">\[Y_{ij} = \mu + T_i + \epsilon_{(i)j} \]</span></p>
<p>So the missing value would be equal to <span class="math inline">\(\mu + Ti\)</span>, where <span class="math inline">\(i\)</span> would be whatever treatment level the missing plot received.</p>
<p>In a randomized complete block design, the the linear additive model is:</p>
<p><span class="math display">\[Y_{ij} = \mu + B_i + T_j + BT_{ij} \]</span></p>
<p>The missing value would be equal to <span class="math inline">\(\mu + B_i + T_j\)</span>, where <span class="math inline">\(i\)</span> is the block to which the missing plot occurred, and <span class="math inline">\(j\)</span> is the treatment the treatment the missing plot received.</p>
<p>Note that we did not include <span class="math inline">\(\epsilon_{(i)j}\)</span> or <span class="math inline">\(BT_{ij}\)</span> in estimating the missing values. Although this approach is widely used, this is a shortcome. When we predict a missing value from the effects of treatment or treatment within block, we are using <em>mean</em> effects. So the predicted value will be exactly the mean for a given treatment or treatment within block. Because the predicted value is closer to the treatment and block means than it would be otherwise, it will contribute less to the treatment variance than it would normally.</p>
<p>We can demonstrate this with a normally-distributed dataset.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="messy-and-missing-data.html#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083020</span>)</span>
<span id="cb264-2"><a href="messy-and-missing-data.html#cb264-2" aria-hidden="true" tabindex="-1"></a>more_norm_data_1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">165</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-3"><a href="messy-and-missing-data.html#cb264-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;A&quot;</span>)</span>
<span id="cb264-4"><a href="messy-and-missing-data.html#cb264-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083021</span>)</span>
<span id="cb264-5"><a href="messy-and-missing-data.html#cb264-5" aria-hidden="true" tabindex="-1"></a>more_norm_data_2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">169</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-6"><a href="messy-and-missing-data.html#cb264-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb264-7"><a href="messy-and-missing-data.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083022</span>)</span>
<span id="cb264-8"><a href="messy-and-missing-data.html#cb264-8" aria-hidden="true" tabindex="-1"></a>more_norm_data_3 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">170</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-9"><a href="messy-and-missing-data.html#cb264-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;C&quot;</span>)</span>
<span id="cb264-10"><a href="messy-and-missing-data.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083023</span>)</span>
<span id="cb264-11"><a href="messy-and-missing-data.html#cb264-11" aria-hidden="true" tabindex="-1"></a>more_norm_data_4 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">172</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-12"><a href="messy-and-missing-data.html#cb264-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;D&quot;</span>)</span>
<span id="cb264-13"><a href="messy-and-missing-data.html#cb264-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-14"><a href="messy-and-missing-data.html#cb264-14" aria-hidden="true" tabindex="-1"></a>more_norm_data <span class="ot">=</span> <span class="fu">rbind</span>(more_norm_data_1, more_norm_data_2, more_norm_data_3, more_norm_data_4) <span class="sc">%&gt;%</span></span>
<span id="cb264-15"><a href="messy-and-missing-data.html#cb264-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as.factor</span>(trt)) <span class="sc">%&gt;%</span>   </span>
<span id="cb264-16"><a href="messy-and-missing-data.html#cb264-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">random_no =</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb264-17"><a href="messy-and-missing-data.html#cb264-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(random_no) <span class="sc">%&gt;%</span></span>
<span id="cb264-18"><a href="messy-and-missing-data.html#cb264-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plot=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb264-19"><a href="messy-and-missing-data.html#cb264-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plot, trt, yield) <span class="sc">%&gt;%</span></span>
<span id="cb264-20"><a href="messy-and-missing-data.html#cb264-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">round</span>(yield,<span class="dv">1</span>))</span>
<span id="cb264-21"><a href="messy-and-missing-data.html#cb264-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-22"><a href="messy-and-missing-data.html#cb264-22" aria-hidden="true" tabindex="-1"></a>more_norm_data</span></code></pre></div>
<pre><code>##    plot trt yield
## 1     1   A 165.0
## 2     2   C 172.1
## 3     3   C 169.3
## 4     4   D 170.1
## 5     5   B 171.6
## 6     6   C 172.3
## 7     7   B 161.3
## 8     8   A 175.3
## 9     9   B 162.1
## 10   10   D 166.3
## 11   11   C 167.1
## 12   12   D 174.2
## 13   13   D 166.7
## 14   14   A 158.3
## 15   15   B 169.7
## 16   16   A 160.3</code></pre>
<p>Here is the anova for the original data:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="messy-and-missing-data.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield<span class="sc">~</span>trt, <span class="at">data=</span>more_norm_data))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## trt          3  80.13   26.71   1.021  0.418
## Residuals   12 313.84   26.15</code></pre>
<p>And here is the boxplot:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="messy-and-missing-data.html#cb268-1" aria-hidden="true" tabindex="-1"></a>more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb268-2"><a href="messy-and-missing-data.html#cb268-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb268-3"><a href="messy-and-missing-data.html#cb268-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb268-4"><a href="messy-and-missing-data.html#cb268-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb268-5"><a href="messy-and-missing-data.html#cb268-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb268-6"><a href="messy-and-missing-data.html#cb268-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data-science-for-agricultural-professionals_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<p>Here is the table with the treatment and error effects broken out. Unlike previous effects tables, I have also added the within treatment variance.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="messy-and-missing-data.html#cb269-1" aria-hidden="true" tabindex="-1"></a>more_norm_data_effects <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb269-2"><a href="messy-and-missing-data.html#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb269-3"><a href="messy-and-missing-data.html#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb269-4"><a href="messy-and-missing-data.html#cb269-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield),</span>
<span id="cb269-5"><a href="messy-and-missing-data.html#cb269-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb269-6"><a href="messy-and-missing-data.html#cb269-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb269-7"><a href="messy-and-missing-data.html#cb269-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb269-8"><a href="messy-and-missing-data.html#cb269-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb269-9"><a href="messy-and-missing-data.html#cb269-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb269-10"><a href="messy-and-missing-data.html#cb269-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-11"><a href="messy-and-missing-data.html#cb269-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_effects)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
trt
</th>
<th style="text-align:right;">
yield
</th>
<th style="text-align:right;">
mu
</th>
<th style="text-align:right;">
trt_var
</th>
<th style="text-align:right;">
trt_effect
</th>
<th style="text-align:right;">
error_effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
165.0
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
57.589167
</td>
<td style="text-align:right;">
-2.88125
</td>
<td style="text-align:right;">
0.275
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.1
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
2.59375
</td>
<td style="text-align:right;">
1.900
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
169.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
2.59375
</td>
<td style="text-align:right;">
-0.900
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
170.1
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
1.71875
</td>
<td style="text-align:right;">
0.775
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
171.6
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-1.43125
</td>
<td style="text-align:right;">
5.425
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
2.59375
</td>
<td style="text-align:right;">
2.100
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
161.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-1.43125
</td>
<td style="text-align:right;">
-4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
175.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
57.589167
</td>
<td style="text-align:right;">
-2.88125
</td>
<td style="text-align:right;">
10.575
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
162.1
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-1.43125
</td>
<td style="text-align:right;">
-4.075
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
1.71875
</td>
<td style="text-align:right;">
-3.025
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
167.1
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
2.59375
</td>
<td style="text-align:right;">
-3.100
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
174.2
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
1.71875
</td>
<td style="text-align:right;">
4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.7
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
1.71875
</td>
<td style="text-align:right;">
-2.625
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
158.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
57.589167
</td>
<td style="text-align:right;">
-2.88125
</td>
<td style="text-align:right;">
-6.425
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
169.7
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-1.43125
</td>
<td style="text-align:right;">
3.525
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
160.3
</td>
<td style="text-align:right;">
167.6062
</td>
<td style="text-align:right;">
57.589167
</td>
<td style="text-align:right;">
-2.88125
</td>
<td style="text-align:right;">
-4.425
</td>
</tr>
</tbody>
</table>
<p>Plot 8 has a greater error effect than most other plots. Let’s treat it as an outlier, delete it, and recalculate the treatment means. Let’s delete it and see how that changes the treatment effect for treatment C.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="messy-and-missing-data.html#cb270-1" aria-hidden="true" tabindex="-1"></a>plot_8 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="cn">NA</span>)</span>
<span id="cb270-2"><a href="messy-and-missing-data.html#cb270-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-3"><a href="messy-and-missing-data.html#cb270-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb270-4"><a href="messy-and-missing-data.html#cb270-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-5"><a href="messy-and-missing-data.html#cb270-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8)  <span class="sc">%&gt;%</span></span>
<span id="cb270-6"><a href="messy-and-missing-data.html#cb270-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb270-7"><a href="messy-and-missing-data.html#cb270-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-8"><a href="messy-and-missing-data.html#cb270-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb270-9"><a href="messy-and-missing-data.html#cb270-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb270-10"><a href="messy-and-missing-data.html#cb270-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-11"><a href="messy-and-missing-data.html#cb270-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb270-12"><a href="messy-and-missing-data.html#cb270-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb270-13"><a href="messy-and-missing-data.html#cb270-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb270-14"><a href="messy-and-missing-data.html#cb270-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb270-15"><a href="messy-and-missing-data.html#cb270-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-16"><a href="messy-and-missing-data.html#cb270-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
trt
</th>
<th style="text-align:right;">
yield
</th>
<th style="text-align:right;">
mu
</th>
<th style="text-align:right;">
trt_var
</th>
<th style="text-align:right;">
trt_effect
</th>
<th style="text-align:right;">
error_effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
165.0
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
11.830000
</td>
<td style="text-align:right;">
-5.8933333
</td>
<td style="text-align:right;">
3.800
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.1
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
3.1066667
</td>
<td style="text-align:right;">
1.900
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
169.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
3.1066667
</td>
<td style="text-align:right;">
-0.900
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
170.1
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
2.2316667
</td>
<td style="text-align:right;">
0.775
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
171.6
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-0.9183333
</td>
<td style="text-align:right;">
5.425
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
3.1066667
</td>
<td style="text-align:right;">
2.100
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
161.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-0.9183333
</td>
<td style="text-align:right;">
-4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
3.1066667
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
162.1
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-0.9183333
</td>
<td style="text-align:right;">
-4.075
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
2.2316667
</td>
<td style="text-align:right;">
-3.025
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
167.1
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
6.146667
</td>
<td style="text-align:right;">
3.1066667
</td>
<td style="text-align:right;">
-3.100
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
174.2
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
2.2316667
</td>
<td style="text-align:right;">
4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.7
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
13.469167
</td>
<td style="text-align:right;">
2.2316667
</td>
<td style="text-align:right;">
-2.625
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
158.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
11.830000
</td>
<td style="text-align:right;">
-5.8933333
</td>
<td style="text-align:right;">
-2.900
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
169.7
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
27.409167
</td>
<td style="text-align:right;">
-0.9183333
</td>
<td style="text-align:right;">
3.525
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
160.3
</td>
<td style="text-align:right;">
167.0933
</td>
<td style="text-align:right;">
11.830000
</td>
<td style="text-align:right;">
-5.8933333
</td>
<td style="text-align:right;">
-0.900
</td>
</tr>
</tbody>
</table>
<p>We can see that removing the yield data from plot 4 causes the treatment effect of treatment C to change – in fact, it has gone from negative to positive. The other treatment effects have also changed. The within-treatment variance for treatment C has also decreased by about one-third. When we re-run our analysis of variance, we see the treatment effect is 0.062 – almost significant at the P=0.05 level.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="messy-and-missing-data.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  166.1   55.36   3.697 0.0463 *
## Residuals   11  164.7   14.98                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 1 observation deleted due to missingness</code></pre>
<p>What would happen if we estimated the yield for plot 8 using the population mean, mu, and the treatment effect?</p>
<p><span class="math display">\[ Y_{3,4} = \mu + T_i = 168.96 + 1.37 = 170.33 \]</span></p>
<p>We see that mu, treatment variance, treatment effect, and error have again changed. The variance within Treatment 3 has again decreased by about one-third.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="messy-and-missing-data.html#cb273-1" aria-hidden="true" tabindex="-1"></a>plot_8_interp <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="fl">170.33</span>)</span>
<span id="cb273-2"><a href="messy-and-missing-data.html#cb273-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-3"><a href="messy-and-missing-data.html#cb273-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp_8 <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb273-4"><a href="messy-and-missing-data.html#cb273-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb273-5"><a href="messy-and-missing-data.html#cb273-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8_interp) <span class="sc">%&gt;%</span></span>
<span id="cb273-6"><a href="messy-and-missing-data.html#cb273-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb273-7"><a href="messy-and-missing-data.html#cb273-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb273-8"><a href="messy-and-missing-data.html#cb273-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb273-9"><a href="messy-and-missing-data.html#cb273-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb273-10"><a href="messy-and-missing-data.html#cb273-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb273-11"><a href="messy-and-missing-data.html#cb273-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb273-12"><a href="messy-and-missing-data.html#cb273-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb273-13"><a href="messy-and-missing-data.html#cb273-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb273-14"><a href="messy-and-missing-data.html#cb273-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb273-15"><a href="messy-and-missing-data.html#cb273-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb273-16"><a href="messy-and-missing-data.html#cb273-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp_8)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
trt
</th>
<th style="text-align:right;">
yield
</th>
<th style="text-align:right;">
mu
</th>
<th style="text-align:right;">
trt_var
</th>
<th style="text-align:right;">
trt_effect
</th>
<th style="text-align:right;">
error_effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
165.00
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-6.095625
</td>
<td style="text-align:right;">
3.800
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.10
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
4.61338
</td>
<td style="text-align:right;">
2.930375
</td>
<td style="text-align:right;">
1.874
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
169.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
4.61338
</td>
<td style="text-align:right;">
2.930375
</td>
<td style="text-align:right;">
-0.926
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
170.10
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.029375
</td>
<td style="text-align:right;">
0.775
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
171.60
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-1.120625
</td>
<td style="text-align:right;">
5.425
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
4.61338
</td>
<td style="text-align:right;">
2.930375
</td>
<td style="text-align:right;">
2.074
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
161.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-1.120625
</td>
<td style="text-align:right;">
-4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
170.33
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
4.61338
</td>
<td style="text-align:right;">
2.930375
</td>
<td style="text-align:right;">
0.104
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
162.10
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-1.120625
</td>
<td style="text-align:right;">
-4.075
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.029375
</td>
<td style="text-align:right;">
-3.025
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
167.10
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
4.61338
</td>
<td style="text-align:right;">
2.930375
</td>
<td style="text-align:right;">
-3.126
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
174.20
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.029375
</td>
<td style="text-align:right;">
4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.70
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.029375
</td>
<td style="text-align:right;">
-2.625
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
158.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-6.095625
</td>
<td style="text-align:right;">
-2.900
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
169.70
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-1.120625
</td>
<td style="text-align:right;">
3.525
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
160.30
</td>
<td style="text-align:right;">
167.2956
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-6.095625
</td>
<td style="text-align:right;">
-0.900
</td>
</tr>
</tbody>
</table>
<p>And here is the kicker, wait for it…</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="messy-and-missing-data.html#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp_8))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  175.9   58.63   4.271 0.0287 *
## Residuals   12  164.8   13.73                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Our treatment differences are now significant. Why? Because when we estimate a missing value using only the population mean and treatment effect, we decrease the overall variance. And why does that happen? Because we have now created that is almost exactly equal to the treatment mean. Was there a change in the originally observed values associated with this change in significance? No. And this is problem. But there is a way to reduce it.</p>
<p>The problem with the model we have used so far is we did not include the error effect in our yield estimate. If we added it in, our yield estimate for plot 8 would be more appropriate. Of course, we cannot calculate the error effect because it is random and changes among plots. But, knowing that error effects are normally distributed around the treatment mean, we can model that distribution and draw an individual from it at random, to use as the error effect in our estimate.</p>
<p>The error distribution has its own mean, which should be close to zero:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="messy-and-missing-data.html#cb276-1" aria-hidden="true" tabindex="-1"></a>err_mean <span class="ot">=</span> <span class="fu">mean</span>(more_norm_data_interp<span class="sc">$</span>error_effect, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb276-2"><a href="messy-and-missing-data.html#cb276-2" aria-hidden="true" tabindex="-1"></a>err_mean</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>And its own standard deviation:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="messy-and-missing-data.html#cb278-1" aria-hidden="true" tabindex="-1"></a>err_sd <span class="ot">=</span> <span class="fu">sd</span>(more_norm_data_interp<span class="sc">$</span>error_effect, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb278-2"><a href="messy-and-missing-data.html#cb278-2" aria-hidden="true" tabindex="-1"></a>err_sd</span></code></pre></div>
<pre><code>## [1] 3.430275</code></pre>
<p>Knowing these two parameters, we can select a value for our error effect from that distribution.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="messy-and-missing-data.html#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb280-2"><a href="messy-and-missing-data.html#cb280-2" aria-hidden="true" tabindex="-1"></a>err_pred <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, err_mean, err_sd)</span>
<span id="cb280-3"><a href="messy-and-missing-data.html#cb280-3" aria-hidden="true" tabindex="-1"></a>err_pred</span></code></pre></div>
<pre><code>## [1] -4.213954</code></pre>
<p>Let’s plug that into our yield estimate and see how our statistics change.</p>
<p><span class="math display">\[ Y_{3,4} = \mu + T_i = 168.96 + 1.37 - 5.37 = 164.96 \]</span></p>
<p>We see that mu, treatment variance, treatment effect, and error have again changed. The variance within Treatment 3 has again decreased by about one-third.</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="messy-and-missing-data.html#cb282-1" aria-hidden="true" tabindex="-1"></a>plot_8_interp_sd <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="fl">164.96</span>)</span>
<span id="cb282-2"><a href="messy-and-missing-data.html#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="messy-and-missing-data.html#cb282-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp_8_sd <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb282-4"><a href="messy-and-missing-data.html#cb282-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb282-5"><a href="messy-and-missing-data.html#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8_interp_sd) <span class="sc">%&gt;%</span></span>
<span id="cb282-6"><a href="messy-and-missing-data.html#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb282-7"><a href="messy-and-missing-data.html#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb282-8"><a href="messy-and-missing-data.html#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb282-9"><a href="messy-and-missing-data.html#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb282-10"><a href="messy-and-missing-data.html#cb282-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb282-11"><a href="messy-and-missing-data.html#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb282-12"><a href="messy-and-missing-data.html#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb282-13"><a href="messy-and-missing-data.html#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb282-14"><a href="messy-and-missing-data.html#cb282-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb282-15"><a href="messy-and-missing-data.html#cb282-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-16"><a href="messy-and-missing-data.html#cb282-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp_8_sd)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
plot
</th>
<th style="text-align:left;">
trt
</th>
<th style="text-align:right;">
yield
</th>
<th style="text-align:right;">
mu
</th>
<th style="text-align:right;">
trt_var
</th>
<th style="text-align:right;">
trt_effect
</th>
<th style="text-align:right;">
error_effect
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
165.00
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-5.760
</td>
<td style="text-align:right;">
3.800
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.10
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
10.10152
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
2.948
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
169.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
10.10152
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
0.148
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
170.10
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.365
</td>
<td style="text-align:right;">
0.775
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
171.60
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-0.785
</td>
<td style="text-align:right;">
5.425
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
172.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
10.10152
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
3.148
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
161.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-0.785
</td>
<td style="text-align:right;">
-4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
164.96
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
10.10152
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
-4.192
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
162.10
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-0.785
</td>
<td style="text-align:right;">
-4.075
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.365
</td>
<td style="text-align:right;">
-3.025
</td>
</tr>
<tr>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
C
</td>
<td style="text-align:right;">
167.10
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
10.10152
</td>
<td style="text-align:right;">
2.192
</td>
<td style="text-align:right;">
-2.052
</td>
</tr>
<tr>
<td style="text-align:right;">
12
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
174.20
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.365
</td>
<td style="text-align:right;">
4.875
</td>
</tr>
<tr>
<td style="text-align:right;">
13
</td>
<td style="text-align:left;">
D
</td>
<td style="text-align:right;">
166.70
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
13.46917
</td>
<td style="text-align:right;">
2.365
</td>
<td style="text-align:right;">
-2.625
</td>
</tr>
<tr>
<td style="text-align:right;">
14
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
158.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-5.760
</td>
<td style="text-align:right;">
-2.900
</td>
</tr>
<tr>
<td style="text-align:right;">
15
</td>
<td style="text-align:left;">
B
</td>
<td style="text-align:right;">
169.70
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
27.40917
</td>
<td style="text-align:right;">
-0.785
</td>
<td style="text-align:right;">
3.525
</td>
</tr>
<tr>
<td style="text-align:right;">
16
</td>
<td style="text-align:left;">
A
</td>
<td style="text-align:right;">
160.30
</td>
<td style="text-align:right;">
166.96
</td>
<td style="text-align:right;">
11.83000
</td>
<td style="text-align:right;">
-5.760
</td>
<td style="text-align:right;">
-0.900
</td>
</tr>
</tbody>
</table>
<p>When we looks at the ANOVA, we see that the mean square and p-value are approximately the same as they were before the missing value was interpolated.</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="messy-and-missing-data.html#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp_8_sd))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  148.4   49.46   3.179 0.0633 .
## Residuals   12  186.7   15.56                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In R, there is a nice package called <em>mice</em> that does this for us. We will learn about it in an exercise this week.</p>
<p>One final note, however: we should not interpolate missing values if 5% or more of the data are missing. Why? Because, as we have seen above, that interpolated value can markedly change our interpretation of the data. Restricting interpolation to datasets where a small percentage of data are missing reduces the leverage one observation has on conclusions from the data. It also increases the accuracy of the interpolated values.</p>
<p>In smaller datasets, then, we may to use the approaches above. How important is it to have that treatment in the trial, versus losing a replicaton of the other treatments? For the latter option, you may want to test whether including or omitting that replicate changes your conclusion from the data. If not, it may be easiest to drop the replication.</p>
</div>
<div id="summary" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Summary</h2>
<p>Agronomic data are rarely nice and neat. The scale in which we work (acres and hectares), plus the variations in soil types, equipment performance, weather, weeds and other pests, make it virtually impossible to ensure our experimental units are near-equivalent. Above all, our subjects are alive and integrate every aspect of their environment into their growth. Unlike human subjects, corn plants cannot answer a history questionnaire. Months or years of a trial can be erased by one plugged nozzle, one broken singulator, one strong wind, one “white combine”. It’s a nasty business.</p>
<p>It is important that we inspect our data and consider its shortcomings. We have ways to address these shortcomings. Outliers may be trimmed, or we may use other techniques to overcome them. We have also learned how to re-scale data (using logarithms or square roots) so that variances are closer to equal, and how to “fill in” missing values using imputation so that our datasets can be balanced.</p>
<p>If stuck, consult with other data scientists. There are “robust” statistics that are based on using the median, rather than the mean, for summaries and tests. There are also non-parametric tests, some of which we will be introduced to towards the end of this course. Non-parametric methods don’t use linear models – therefore, they are more insulated from the problems discussed above. We will learn about these in a future unit.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="means-separation-and-data-presentation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-and-simple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/09-Messy-and-Missing-Data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["data-science-for-agricultural-professionals.pdf", "data-science-for-agricultural-professionals.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
